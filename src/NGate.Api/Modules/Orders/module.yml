name: Orders
path: /orders
routes:
- upstream: /
  method: GET
  use: downstream
  downstream: orders-service/orders?customerId=@user_id
- upstream: /{orderId}
  method: GET
  use: downstream
  downstream: orders-service/orders/{orderId}
- upstream: /
  method: POST
  use: dispatcher
  exchange: orders.create_order
  routing_key: create_order
  bind:
  - customerId:@user_id
  transform:
  - test:nothing
  payload: create_order
  schema: create_order.schema
- upstream: /sync/{orderId}
  generate_resource_id: true
  method: POST
  downstream_method: PUT
  use: downstream
  downstream: orders-service/orders/{orderId}
  bind:
  - customerId:@user_id
  transform:
  - customerId:user
  payload: create_order
- upstream: /{id}
  method: DELETE
  use: dispatcher
  exchange: orders.cancel_order
  routing_key: cancel_order
  bind:
  - id:{id}
  - customerId:@user_id
  payload: cancel_order
services:
  orders-service:
    url: localhost:9999/orders-service